<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>find CF high ip</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .scrollable-div {
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
        }

        select {
            display: block;
            margin: 0 auto 10px auto;
            font-size: 18px;
            font-weight: bold;
            padding: 6px 12px;
        }

        textarea {
            width: 100%;
            height: 150px;
            margin-top: 10px;
        }

        input[type="text"] {
            width: 100%;
            margin-top: 10px;
            padding: 6px;
        }

        button {
            margin-top: 10px;
            padding: 8px 16px;
        }
    </style>
</head>

<body>


    <!-- 选择处理模式 -->
    <select id="mode" onchange="selectMode(this.value)">
        <option value=""></option>
        <option value="appInfo">工具 基本使用 方法</option>
        <option value="getCensys">获取 censys 方法</option>
        <option value="getFofa"> 获取 fofa 方法 </option>
        <option value="getIpList"> 获取 ip段 列表 </option>
        <option value="dmitHighIp"> 大妈 ip段 列表 </option>
        <option value="bwhHighIp"> 瓦工 ip段 列表 </option>
        <option value="as979HighIp"> AS979 ip段 列表 </option>
        <option value="generateCensys">生成 censys 代码</option>
        <option value="generateFofa">生成 fofa 代码</option>
        <option value="setCensys">censys 文本处理</option>
        <option value="setFofa">fofa 文本处理</option>
        <option value="toIpPort">url to ip&port </option>
        <option value="toUrl"> ip&port to Url </option>
    </select>

    <div id="info"></div>

    <div id="main">
        <!-- 输入文本 -->
        <textarea id="input"></textarea>

        <!-- 附加文本 -->
        <input type="text" id="extra">

        <button id="send" onclick="send()">提交</button>

        <button style="float: right;" onclick="_clear()">清除</button>
        <p></p>
        <div class="scrollable-div" id="output"></div>
        <p></p>
        <button id="copy" onclick="copy()">复制</button>
    </div>

    <script>

        let ModeVar = ""
        let UserDate = ""
        document.getElementById("copy").style.visibility = 'hidden';

        function selectMode(mode) {

            const modeList = [
                "appInfo",
                "getCensys",
                "getFofa",
                "getIpList",
                "dmitHighIp",
                "bwhHighIp",
                "as979HighIp"
            ]

            let isInfo = false


            if (ModeVar === mode) {
                return
            }

            ModeVar = mode

            for (const m of modeList) {
                if (m === mode) {
                    isInfo = true
                    continue
                }
            }

            document.getElementById("input").value = "";
            document.getElementById("output").innerHTML = "";
            document.getElementById("extra").value = "";
            UserDate = "";

            if (isInfo) {
                document.getElementById("main").style.visibility = 'hidden'
                document.getElementById("info").style.visibility = 'visible'
            } else {

                document.getElementById("info").innerHTML = ""
                document.getElementById("main").style.visibility = 'visible'
                document.getElementById("info").style.visibility = 'hidden'
                document.getElementById("copy").style.visibility = 'hidden'

                return
            }

            let text = ""

            if (mode === "appInfo") {
                text = appInfoText();
            } else if (mode === "getCensys") {
                text = getCensysText();
            } else if (mode === "getFofa") {
                text = getFofaText();
            } else if (mode === "getIpList") {
                text = getIpListText();
            } else if (mode === "dmitHighIp") {
                text = dmitHighIpText();
                text = text.replace(/\n/g, "<br\>");
            } else if (mode === "bwhHighIp") {
                text = bwhHighIpText();
                text = text.replace(/\n/g, "<br\>");
            } else if (mode === "as979HighIp") {
                text = as979HighIpText();
                text = text.replace(/\n/g, "<br\>");
            }



            document.getElementById("info").innerHTML = text
        }

        function send() {
            const text = document.getElementById("input").value;
            const mode = document.getElementById("mode").value;
            const extra = document.getElementById("extra").value;
            UserDate = "";

            let resultLines;
            if (mode === "generateCensys" || mode === "generateFofa") {
                resultLines = generateCensysFofa(mode, text, extra);

            } else if (mode === "setCensys") {
                let urls = ""
                const match = splitUrl(extra);

                if (!match) {
                    return ""
                }

                for (const ipText of splitCensysByIP(text)) {
                    urls += setCensysProxyUrl(ipText, match)
                }

                UserDate = urls;
                resultLines = urls.replace(/\n/g, "<br\>");

                if (UserDate) {
                    document.getElementById("copy").style.visibility = 'visible';
                } else {
                    document.getElementById("copy").style.visibility = 'hidden';
                }

            } else if (mode === "setFofa") {


                const urls = setFofaProxyUrl(text, extra);
                UserDate = urls;
                resultLines = urls.replace(/\n/g, "<br\>");

                if (UserDate) {
                    document.getElementById("copy").style.visibility = 'visible';
                } else {
                    document.getElementById("copy").style.visibility = 'hidden';
                }

            } else if (mode === "toIpPort" || mode === "toUrl") {
                const result = toUrlOrIpPort(mode, text, extra)
                UserDate = result
                resultLines = result.replace(/\n/g, "<br\>");

                if (UserDate) {
                    document.getElementById("copy").style.visibility = 'visible';
                } else {
                    document.getElementById("copy").style.visibility = 'hidden';
                }


            } else {
                resultLines = "";
            }

            if (resultLines === "") {
                if (mode === "generateCensys" || mode === "generateFofa") {
                    alert('无法生成链接,请提供正确的 ip 段!')
                } else {
                    alert('没找到任何结果,请检查模式或输入文本是否正常!')
                }
            }


            document.getElementById("output").innerHTML = resultLines;
        }

        function generateCensysFofa(mode, text, size) {

            let isJump = true;
            let url
            let ipcs = []

            const re = /^\s*(\d+)\.(\d+)\.(\d+)\.(\d+)\/(\d+)/gm
            const matches = text.matchAll(re)

            if (text.search(re) === -1) {
                return ""
            }

            if (mode === "generateCensys") {
                url = `<p>搜索引擎: <a href="https://platform.censys.io" target="_blank" rel="noopener noreferrer" > https://platform.censys.io </a></p>\n`
            } else {
                url = `<p>搜索引擎: <a href="https://fofa.info" target="_blank" rel="noopener noreferrer" > https://fofa.info </a></p>\n`
            }

            if (/^\d+$/.test(size)) {
                if (size > 1 && size < 17) {
                    isJump = false;
                }
            }

            if (isJump) {

                for (const ipc of matches) {
                    ipcs.push(`${ipc[1]}.${ipc[2]}.${ipc[3]}.${ipc[4]}/${ipc[5]}`)
                }

                if (mode === "generateCensys") {
                    return url + generateCensysUrl(ipcs)
                } else {
                    return url + generateFofaUrl(ipcs)
                }
            }

            let result = ""
            let uc = 1
            let a, b, c, d, e

            for (const ipc of matches) {

                e = ipc[5] - 0

                if (e > 16 && e < 24) {
                    a = ipc[1] - 0
                    b = ipc[2] - 0
                    c = ipc[3] - 0
                    d = ipc[4] - 0

                    for (let i = 0; i < 2 ** (24 - ipc[5]); i++) {
                        ipcs.push(`${a}.${b}.${c}.${d}/24`)
                        if (c < 255) {
                            c += 1
                        } else {
                            b += 1
                            c = 0

                            if (b > 255) {
                                b = 0
                                a += 1
                            }
                        }
                    }

                } else {
                    ipcs.push(`${ipc[1]}.${ipc[2]}.${ipc[3]}.${ipc[4]}/${ipc[5]}`)
                }

            }


            size -= 0

            for (let i = 0; i < ipcs.length; i += size) {

                if (mode === "generateCensys") {
                    result += `${uc}.<br\>` + generateCensysUrl(ipcs.slice(i, i + size))
                } else {
                    result += `${uc}.<br\>` + generateFofaUrl(ipcs.slice(i, i + size))
                }
                uc += 1
            }

            return url + result


        }

        function generateCensysUrl(ipcs) {
            let cmd = 'host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:{ 400, 403} and '

            if (ipcs.length == 1) {
                cmd += `host.ip:"${ipcs[0]}"`
            } else {

                cmd += `host.ip:{ "${ipcs[0]}"`

                for (let i = 1; i < ipcs.length; i++) {
                    cmd += `, "${ipcs[i]}"`
                }

                cmd += ' }'
            }

            const url = 'https://platform.censys.io/search?q=' + encodeURIComponent(cmd)

            return `
            搜索代码: ${cmd}
            <p></p>
            搜索链接: <a href="${url}" target="_blank" rel="noopener noreferrer" >${url}</a>
            <p></p>
            `

        }

        function generateFofaUrl(ipcs) {

            let cmd = 'cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && '

            if (ipcs.length == 1) {
                cmd += `ip="${ipcs[0]}"`
            } else {
                cmd += `( ip="${ipcs[0]}"`

                for (let i = 1; i < ipcs.length; i++) {
                    cmd += ` || ip="${ipcs[i]}"`
                }

                cmd += ' )'
            }

            const url = 'https://fofa.info/result?qbase64=' + toQBase64(cmd)

            return `
            搜索代码: ${cmd}
            <p></p>
            搜索链接: <a href="${url}"  target="_blank" rel="noopener noreferrer" >${url}</a>
            <p></p>
            `

        }

        function splitUrl(url) {
            const re = /^(.*?\@).*?\:\d+(?:\\|)(\?.*)$/
            const match = url.match(re)

            if (!match) {
                if (url.startsWith("vmess://")) {

                    const str = base64DecodeUnicode(url.slice(8))

                    if (str) {
                        let vmessUrl = ["", "", ""]
                        const json = JSON.parse(str)
                        if (json.id && json.host && json.sni) {

                            vmessUrl[1] = "vmess://" + json.id + "@"
                            vmessUrl[2] = "?encryption=auto" +
                                "&type=" + json.net +
                                "&security=tls" +
                                "&path=" + encodeURIComponent(json.path) +
                                "&host=" + json.host +
                                "&fp=chrome" +
                                "&sni=" + json.sni +
                                "#" + encodeURIComponent(json.ps)
                            return vmessUrl
                        }
                    }
                }
                alert('提供"VLESS"或"VMESS"格式不正确!')
            }

            return match
        }

        function setCensysProxyUrl(text, urlMatch) {

            let urls = ""
            const ipMatch = text.match(/\d+\.\d+\.\d+\.\d+/)
            const portsMatch = text.matchAll(/\s*(\d+)\s*\/\s*HTTP/g)
            for (const p of portsMatch) {
                const ip = ipMatch[0] + ":" + p[1]
                urls += urlMatch[1] + ip + urlMatch[2] + "\n"
            }

            return urls
        }

        function splitCensysByIP(text) {
            const ipRe = /\d+\.\d+\.\d+\.\d+/g
            const result = []

            // 1. 找第一个 IP
            const firstMatch = text.match(ipRe)
            if (!firstMatch) {
                return result
            }

            const firstIndex = text.indexOf(firstMatch[0])

            // 切掉前面的垃圾文本
            text = text.slice(firstIndex)

            while (true) {
                // 2. 找当前 text 里的前两个 IP
                const matches = [...text.matchAll(ipRe)]

                if (matches.length === 1) {
                    // 最后一个 IP，全部加入
                    result.push(text.trim())
                    break
                }

                // 第二个 IP 的起始位置
                const secondIPIndex = matches[1].index

                const block = text.slice(0, secondIPIndex)
                result.push(block.trim())

                // 切掉已处理部分
                text = text.slice(secondIPIndex)
            }

            return result
        }

        function setFofaProxyUrl(text, proxyUrl) {

            const urlMatch = splitUrl(proxyUrl)

            if (!urlMatch) {
                return ""
            }

            let urls = ""
            const ipRe = /^\s*https:\/\/(\d+\.\d+\.\d+\.\d+(?:\:\d+)?)\s+/mg;


            for (const p of text.matchAll(ipRe)) {
                let ip
                if (p[1].match(/\:\d+$/)) {
                    ip = p[1]
                } else {
                    ip = p[1] + ":443"
                }
                urls += urlMatch[1] + ip + urlMatch[2] + "\n"
            }

            return urls
        }

        function toUrlOrIpPort(mode, text, extra) {

            let ipRe
            let strA, strB, strC

            if (mode === "toUrl") {
                const urlMatch = splitUrl(extra)

                if (!urlMatch) {
                    return ""
                }
                strA = urlMatch[1]
                strB = ":"
                strC = urlMatch[2] + "\n"

                ipRe = /(\d+\.\d+\.\d+\.\d+)\s*(?:\,|\:|)\s*(\d+)/;
            } else {

                strA = ""
                strB = ","
                if (extra) {
                    strC = "#" + extra + "\n"
                } else {
                    strC = "\n"
                }

                ipRe = /\@(\d+\.\d+\.\d+\.\d+)\:(\d+)(?:\\|)\?/;

            }

            let result = ""

            const ips = (text + "\n").split("\n")

            for (let i = 0; i < ips.length; i++) {

                if (ips == "") {
                    continue
                }

                const match = ips[i].match(ipRe)

                if (match) {
                    result += strA + match[1] + strB + match[2] + strC
                } else {
                    if (ips[i].startsWith("vmess://")) {

                        const str = base64DecodeUnicode(ips[i].slice(8))

                        if (str) {
                            const json = JSON.parse(str)
                            if (json.add && json.port) {
                                result += strA + json.add + strB + json.port + strC
                            }
                        }

                    }

                }
            }

            return result
        }

        function _clear() {
            document.getElementById("input").value = "";
            document.getElementById("extra").value = "";
        }

        function copy(text = UserDate) {
            if (text === "") {
                return
            }
            navigator.clipboard.writeText(text)
                .then(() => {
                    alert('复制成功！');
                })
                .catch(err => {
                    alert('复制失败，请检查浏览器权限。');
                });
        }

        function isBase64(str) {
            return /^[A-Za-z0-9+/]+={0,2}$/.test(str) && str.length % 4 === 0;
        }

        function base64DecodeUnicode(str) {
            if (!isBase64(str)) return '';

            try {
                return decodeURIComponent(atob(str).split('').map(function (c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
            } catch {
                return '';
            }
        }


        function toQBase64(str) {

            const match = btoa(str).match(/=+$/)


            let d = ""

            if (match) {
                for (let i = 1; i <= match[0].length; i++) {
                    d += "%3D"
                }
            }


            return btoa(str)
                .replace(/\+/g, '-')
                .replace(/\//g, '_')
                .replace(/=+$/, d);
        }

        function appInfoText() {
            return `
           <p> 1.选择框,选处理模式或查看教程 </p>
           <p> 2.第一个文本框,主要粘贴要处理的数据 </p>
           <p> 3.第二个条形框,只要粘贴 你的 任意 cf 链接 , 或 url to ip&port 的名称 </p>
           <p> 4.第三个文本框,处理数据,后的结果 </p>
            `
        }

        function getCensysText() {
            const censysUrl = `<a href="https://platform.censys.io" target="_blank" rel="noopener noreferrer" > https://platform.censys.io </a>`
            const heUrl = `<a href="https://bgp.he.net" target="_blank" rel="noopener noreferrer" > https://bgp.he.net </a>`
            return `
            <p> 搜索引擎: ${censysUrl} (复杂,搜索精准高,要找到更好结果的老司机选择) </p>
            (免费账号,每月 搜索100次, 每页100条,不能翻页,无法下载(其实不登录一样可以搜索,换ip就可以,不过额度好低)<br\>
            不要点击看详细ip信息,会消耗额度(勿点), <br\>
            因为每次100条, 所以 搜索 ip段 不要设置太大, host.ip:{x.x.x.x/24 , x.x.x.x/24} 两三个 x.x.x.x/24 段 同时搜索 ,或 单个 x.x.x.x/16 ,具体看结果添加ip段 <br\>
            但命中率高,更新快)<br\>
            <br\>
            <p> 1.搜索 </p>
            <p> 1.1.搜索完整代码例子(在免费额度高效找出有用ip): </p>
            host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:"403" and host.autonomous_system.asn:"906" and host.location.country="United States" and host.ip:{"154.17.0.0/16" , "154.21.0.0/16" , "154.26.0.0/16" , "69.63.0.0/16"}<br\>
            <br\>
            <p> 1.2.搜索代码分析: </p>
            <p>1.2.1.不用改动部分,(cf 信息与状态)<br\>
            host.services.software:(vendor = "cloudflare" and product = "waf") <br\>
            host.services.endpoints.http.status_code:"403" //改 "400" 精度更高<br\>
            ( 或 一起 使用,<br\>
             host.services.endpoints.http.status_code:{403,400}<br\>
            )<br\>
             <p> 1.2.2.主要改动部分 </p>
             host.autonomous_system.asn:"906" // 指定 vps 的 asn (例如: "25820")<br\>
             host.location.country="United States" // 指定 vps 的 地区 (例如: HongKong)<br\>
             host.ip:{"154.17.0.0/16" , "154.21.0.0/16" , "154.26.0.0/16" , "69.63.0.0/16"} // 指定 搜索的ip段 (例子中,已经超过100条,免费额度不够)<br\>
             ( <br\>
             如果 搜索 x.x.x.x/24 (可以从 ${heUrl} 找到 asn 的 ip段 ) 不用指定 host.autonomous_system.asn , host.location.country (建议两三个/24,不然容易超过100条)<br\>
             例子: host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:"403" and host.ip:"154.17.224.0/24" // 不建议单个ip段,容易浪费额度 多个ip段 host.ip:{"154.17.224.0/24","154.17.225.0/24","154.17.226.0/24"}<br\>
             如果 搜索 x.x.x.x/16 , x.x.x.x/8 需要指定 host.autonomous_system.asn , host.location.country (/16 , /8 ip太多 会现在 其他 asn 其他 地区的ip ,免费额度不够)<br\>
             例子: host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:"403" and host.autonomous_system.asn:"906" and host.location.country="United States" and host.ip:"154.17.0.0/16"  // 不建议单个ip段,容易浪费额度 多个ip段 host.ip:{ "154.26.0.0/16" , "69.0.0.0/8}<br\>
             )<br\>
             <p> ps.生成搜索代码(高效并节约额度) </p>
             先在 ${heUrl} 找到 vps 供应商 的 ip 段 (可选择工具自带, 获取 ip段 列表 或  各 vps 优化 ip 段列表 查看 ip 段)<br\>
             选择 生成 censys 代码 , 复制 ip 段(格式: x.x.x.x/x .... ,后面没用代码自动过滤,建议一次不要太多ip段)<br\>
             粘贴到一个文本框,点击提交,即可生成!<br\>
             <br\>
             <p> 2.下载结果: </p>
             免费用户是无法下载,只能网页提取数据, 直接 选中所有 网页 搜索出来的结果,然后复制! (复制ip信息部分既可,自动去取网页样式和布局)<br\>
             <br\>
            <p> 3.数据处理: </p>
             3.1.选择 censys 文本处理 模式<br\>
             3.2.数据粘贴到 第一个文本框<br\>
             3.3.你的 任意 cf 链接 粘贴到 第二个条形框<br\>
             3.4.点击提交 , 第三个文本框出结果<br\>
             <br\>
             <p> 4.测试结果: </p>
             4.1.生成链接,不是所以都有效的,需要使用v2rayN 大量测试<br\>
             4.2.建议在,v2rayN,创建一个测试组<br\>
             4.3.将结果粘贴到测试组,按 Crtl+a 全选, 再 按 Crtl+r 测试 链接, 有延迟,就是可用的!<br\>
             4.4.点击延迟排序,再选中无效的链接再测多几次(找漏网之鱼)<br\>
             4.5.最后,v2rayN 鼠标 右键菜单选择 按测试结果移除无效<br\>
        `
        }

        function getFofaText() {
            const fofaUrl = `<a href="https://fofa.info" target="_blank" rel="noopener noreferrer" > https://fofa.info </a>`
            const heUrl = `<a href="https://bgp.he.net" target="_blank" rel="noopener noreferrer" > https://bgp.he.net </a>`
            return `
          <p> 搜索引擎: ${fofaUrl} (比较简单,搜索精准低,小白优先选择) </p>
           (免费账号,每月 搜索300次,下载3000条<br\>
           简单易用,但更新慢,一些数据过时)<br\>
           <br\>
           <p> 1.搜索 </p>
           1.1.搜索完整代码例子(在免费额度高效找出有用ip):<br\>
           cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && asn=="906" && country=="US" && (ip="154.17.0.0/16" || ip="154.21.0.0/16" || ip="154.26.0.0/16" || ip="69.63.0.0/16")<br\>
           <br\>
           <p> 1.2.搜索代码分析: </p>
           <p> 1.2.1.不用改动部分,(cf 信息与状态) <p>
           cloud_name="Cloudflare" <br\>
           status_code="403"<br\>
           tls.version="TLS 1.3"<br\>
           <p> 1.2.2.主要改动部分: </p>
           asn=="906" // 指定 vps 的 asn (例如: "25820")<br\>
           country=="US" // 指定 vps 的 地区 (例如: HK)<br\>
           (ip="154.17.0.0/16" || ip="154.21.0.0/16" || ip="154.26.0.0/16" || ip="69.63.0.0/16") // 指定 搜索的ip段  (例子中,之前搜索过大约有700多条,免费额度完全够下载,不过会有漏网之鱼)<br\>
           ( <br\>
           如果 搜索 x.x.x.x/24 (可以从 ${heUrl} 找到 asn 的 ip段 ) 不用指定 asn , country <br\>
           例子:  cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && ip="154.17.224.0/24" // 不建议单个ip段,容易浪费额度 多个ip段 (ip="154.17.224.0/24" || ip="154.17.225.0/24" || ip="154.17.226.0/24" )<br\>
           如果 搜索 x.x.x.x/16 , x.x.x.x/8 需要指定 asn , country (/16 , /8 ip太多,额度免费不够)<br\>
           例子: cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && asn=="906" && country=="US" && ip="154.17.0.0/16" // 不建议单个ip段,容易浪费额度 多个ip段 (ip="154.17.0.0/16" || ip="69.0.0.0/8")<br\>
           <p> ps.生成搜索代码(高效并节约额度) </p>
           先在 ${heUrl} 找到 vps 供应商 的 ip 段 (可选择工具自带, 获取 ip段 列表 或  各 vps 优化 ip 段列表 查看 ip 段)<br\>
           选择 生成 fofa 代码 , 复制 ip 段(格式: x.x.x.x/x .... ,后面没用代码自动过滤,建议一次不要太多ip段)<br\>
           粘贴到一个文本框,点击提交,即可生成!<br\>
           )<br\>
           <br\>
           <p> 2.下载结果: </p>
           fofa.info 保存结果,下载csv文件,复制所有csv文件内容<br\>
           <br\>
           <p> 3.数据处理: </p>
           3.1.选择 fofa 文本处理 模式<br\>
           3.2.数据粘贴到 第一个文本框<br\>
           3.3.你的 任意 cf 链接 粘贴到 第二个条形框<br\>
           3.4.点击提交 , 第三个文本框出结果<br\>
           <br\>
           <p> 4.测试结果: </p>
           4.1.生成链接,不是所以都有效的,需要使用v2rayN 大量测试<br\>
           4.2.建议在,v2rayN,创建一个测试组<br\>
           4.3.将结果粘贴到测试组,按 Crtl+a 全选, 再 按 Crtl+r 测试 链接, 有延迟,就是可用的!<br\>
           4.4.点击延迟排序,再选中无效的链接再测多几次(找漏网之鱼)<br\>
           4.5.最后,v2rayN 鼠标 右键菜单选择 按测试结果移除无效<br\>
        `
        }

        function asnText(asn) {
            const heUrl = `<a href="https://bgp.he.net/AS${asn}#_prefixes" target="_blank" rel="noopener noreferrer" > https://bgp.he.net/AS${asn}#_prefixes </a>`
            const cCmd = encodeURIComponent(`host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:{403,400} and host.autonomous_system.asn:"${asn}"`);
            const fCmd = toQBase64(`cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && asn="${asn}"`);
            const cUrl = `<a href="https://platform.censys.io/search?q=${cCmd}" target="_blank" rel="noopener noreferrer" > https://platform.censys.io/search?q=${cCmd} </a>`
            const fUrl = `<a href="https://fofa.info/result?qbase64=${fCmd}" target="_blank" rel="noopener noreferrer" > https://fofa.info/result?qbase64=${fCmd} </a>`

            return `
                查看 ip 段: ${heUrl} <br\>
                (<br\>
                censys 搜索代码: host.services.software:(vendor = "cloudflare" and product = "waf") and host.services.endpoints.http.status_code:{403,400} and host.autonomous_system.asn:"${asn}" (所有) <br\>
                所有url: ${cUrl} <br\>
                fofa 搜索代码: cloud_name="Cloudflare" && status_code="403" && tls.version="TLS 1.3" && asn="${asn}" (所有) <br\>
                所有url: ${fUrl} <br\>
                )
                `
        }

        function getIpListText() {
            const heUrl = `<a href="https://bgp.he.net" target="_blank" rel="noopener noreferrer" > https://bgp.he.net </a>`
            const pingUrl = `<a href="https://ping.pe" target="_blank" rel="noopener noreferrer" > https://ping.pe </a>`

            return `
            搜索引擎: ${heUrl} <br\>
            用 bgp.he.net 查 ASN → 看 IPv4 Prefixes <br\>
            <br\>
            大妈 所有ipv4段: <br\> 
            ${asnText('906')} <br\>
            <br\>
            瓦工 所有ipv4段:<br\>
            ${asnText('25820')}<br\>
            <br\>
            AS979 NetLab Global 所有ipv4段:<br\>
            ${asnText('979')}<br\>
            <br\>
            AS8796 FASTNET DATA INC 所有ipv4段:<br\>
            ${asnText('8796')}<br\>
            <br\>
            Evoxt (主打马来鸡) 所有ipv4段:<br\>
            ${asnText('149440')}<br\>
            <br\>
            AS1054 Zont LLC (VMISS 三网) 所有ipv4段:<br\>
            ${asnText('1054')} <br\>
            <br\>
            阿里云 所有ipv4段:<br\>
            ${asnText('45102')}<br\>
            <br\>
            如何找出优化ip:<br\>
            首先 在 x.x.x.x/24 ping (例如: 154.17.224.0/24 154.17.224.0-154.17.224.255 中 随机能 ping 通的 ip)<br\>
            然后上 ${pingUrl} 测试 ip <br\>
            主要观察 ip 的 延迟 , 掉包 是否稳定<br\>
            重要查看国内去程有包含优化线路(AS4089,AS9929,AS58807 有可以确定为优化线路)<br\>

        `
        }

        function dmitHighIpText() {
            return `
            大妈 优化 ip 段 (更新时间 26.01, 三网优化,常态稳定,有 ping)

			69.63.192.0/20
			69.63.192.0/24
			69.63.193.0/24
			69.63.194.0/24
			69.63.195.0/24
			69.63.196.0/24
			69.63.197.0/24
			69.63.198.0/24
			69.63.199.0/24
			69.63.200.0/24
			69.63.201.0/24
			69.63.202.0/24
			69.63.203.0/24
			69.63.204.0/24
			69.63.205.0/24
			69.63.206.0/24
			69.63.207.0/24
			69.63.208.0/20
			69.63.208.0/24
			69.63.209.0/24
			69.63.210.0/24
			69.63.211.0/24
			69.63.212.0/24
			69.63.213.0/24
			69.63.214.0/24
			69.63.215.0/24
			69.63.216.0/24
			69.63.217.0/24
			69.63.218.0/24
			69.63.219.0/24
			69.63.220.0/24
			69.63.221.0/24
			69.63.222.0/24
			69.63.223.0/24
			154.17.0.0/20
			154.17.0.0/24
			154.17.1.0/24
			154.17.2.0/24
			154.17.3.0/24
			154.17.4.0/24
			154.17.5.0/24
			154.17.6.0/24
			154.17.7.0/24
			154.17.8.0/24
			154.17.9.0/24
			154.17.10.0/24
			154.17.11.0/24
			154.17.12.0/24
			154.17.13.0/24
			154.17.14.0/24
			154.17.15.0/24
			154.17.16.0/24
			154.17.17.0/24
			154.17.18.0/24
			154.17.19.0/24
			154.17.20.0/24
			154.17.21.0/24
			154.17.22.0/24
			154.17.23.0/24
			154.17.24.0/24
			154.17.25.0/24
			154.17.26.0/24
			154.17.27.0/24
			154.17.28.0/24
			154.17.29.0/24
			154.17.30.0/24
			154.17.31.0/24
			154.17.224.0/24
			154.17.225.0/24
			154.17.226.0/24
			154.17.227.0/24
			154.17.228.0/24
			154.17.229.0/24
			154.17.230.0/24
			154.17.231.0/24
			154.17.232.0/24
			154.17.233.0/24
			154.17.234.0/24
			154.17.235.0/24
			154.17.236.0/24
			154.17.237.0/24
			154.17.238.0/24
			154.17.239.0/24
			154.21.80.0/24
			154.21.81.0/24
			154.21.82.0/24
			154.21.83.0/24
			154.21.84.0/24
			154.21.85.0/24
			154.21.86.0/24
			154.21.87.0/24
			154.21.88.0/24
			154.21.89.0/24
			154.21.90.0/24
			154.21.91.0/24
			154.21.92.0/24
			154.21.93.0/24
			154.21.94.0/24
			154.21.95.0/24
			154.26.176.0/24
			154.26.177.0/24
			154.26.178.0/24
			154.26.179.0/24
			154.26.180.0/24
			154.26.181.0/24
			154.26.182.0/24
			154.26.183.0/24
			154.26.184.0/24
			154.26.185.0/24
			154.26.186.0/24
			154.26.187.0/24
			154.26.188.0/24
			154.26.189.0/24
			154.26.190.0/24
			154.26.191.0/24
			
        `
        }


        function bwhHighIpText() {
            return `
			瓦工 优化 ip段 (更新时间 26.01, 三网优化,常态稳定,有 ping)

			23.106.152.0/21
			23.252.104.0/22
			45.62.112.0/21
			45.62.124.0/22
			45.78.64.0/20
			46.254.88.0/22
			64.64.224.0/22
			64.64.228.0/22
			64.64.232.0/22
			64.64.236.0/22
			64.64.240.0/22
			64.64.244.0/22
			64.64.248.0/22
			64.64.252.0/22
			65.49.130.0/23
			65.49.131.0/24
			65.49.236.0/22 日本
			67.230.160.0/19
			74.211.96.0/21
			74.211.104.0/21
			80.251.208.0/20
			89.208.240.0/20
			95.181.188.0/22 
			104.193.8.0/22 荷兰
			104.194.64.0/21
			104.194.72.0/22
			104.194.76.0/24
			104.194.77.0/24
			104.194.78.0/23
			104.194.80.0/20
			138.128.192.0/20
			144.34.224.0/20
			144.34.240.0/20
			144.168.56.0/21
			150.242.88.0/24 
			150.242.90.0/24
			150.242.91.0/24
			162.211.220.0/22 荷兰
			162.211.224.0/22
			162.211.228.0/22
			162.244.240.0/24
			162.244.240.0/24 
			162.244.241.0/24
			162.244.242.0/24
			162.244.243.0/24
			162.248.72.0/21
			172.93.32.0/24 加拿大
			173.242.112.0/22
			173.242.116.0/22
			173.242.120.0/22
			173.242.124.0/22
			178.157.48.0/22
			178.157.56.0/22
			178.157.60.0/22
			185.199.240.0/24
			192.69.88.0/22
			192.69.92.0/22
			192.243.112.0/21
			199.19.104.0/21 
			199.168.136.0/22 
			199.168.140.0/22
			199.180.112.0/21 
			199.193.124.0/22 
			216.24.176.0/22 
			216.24.180.0/22
			216.24.184.0/22
			216.24.188.0/22
        `
        }


        function as979HighIpText() {
            return `
			AS979 优化 ip段 (更新时间 26.01,优化线路,但不一定三网全稳,没 ping)

            23.144.132.0/24
            38.22.88.0/21
            38.22.88.0/24
            38.22.89.0/24
            38.22.90.0/24
            38.22.91.0/24
            38.22.92.0/24
            38.22.93.0/24
            38.22.94.0/24
            38.22.95.0/24
            38.22.234.0/23
            38.22.234.0/24
            38.22.235.0/24
            38.58.56.0/22
            38.95.74.0/23
            38.95.74.0/24
            38.95.75.0/24
            38.150.1.0/24
            38.150.2.0/24
            38.150.3.0/24
            38.150.4.0/24
            38.150.5.0/24
            38.150.6.0/24
            38.150.7.0/24
            38.175.192.0/21
            38.175.192.0/24
            38.175.193.0/24
            38.175.194.0/24
            38.175.195.0/24
            38.175.196.0/24
            38.175.197.0/24
            38.175.198.0/24
            38.175.199.0/24
            38.207.190.0/24
            38.207.191.0/24
            38.246.248.0/21
            38.246.248.0/24
            38.246.249.0/24
            38.246.250.0/24
            38.246.251.0/24
            38.246.252.0/24
            38.246.253.0/24
            38.246.254.0/24
            70.39.202.0/24
            70.39.203.0/24
            70.39.204.0/22
            70.39.204.0/24
            70.39.205.0/24
            70.39.206.0/24
            70.39.207.0/24
            72.249.207.0/24
            103.27.76.0/22
            103.27.76.0/24
            103.27.77.0/24
            103.27.78.0/24
            103.27.79.0/24
            103.207.68.0/23
            103.207.68.0/24
            103.207.69.0/24
            154.7.176.0/24
            154.9.24.0/23
            154.9.24.0/24
            154.9.25.0/24
            154.9.252.0/23
            154.9.252.0/24
            154.9.253.0/24
            154.12.59.0/24
            154.12.60.0/22
            154.12.60.0/24
            154.12.61.0/24
            154.12.62.0/24
            154.12.63.0/24
            154.13.6.0/23
            154.13.6.0/24
            154.21.194.0/24
            154.21.200.0/22
            154.21.200.0/24
            154.21.201.0/24
            154.21.202.0/24
            154.21.203.0/24
            154.36.128.0/21
            154.36.162.0/23
            154.36.162.0/24
            154.36.163.0/24
            154.36.164.0/22
            154.36.164.0/24
            154.36.165.0/24
            154.36.173.0/24
            154.36.174.0/23
            154.36.174.0/24
            154.36.175.0/24
            154.36.186.0/23
            154.36.186.0/24
            154.37.154.0/23
            154.37.154.0/24
            154.37.155.0/24
            154.37.212.0/22
            154.37.212.0/24
            154.37.213.0/24
            154.37.214.0/24
            154.37.215.0/24
            154.37.216.0/21
            154.37.216.0/24
            154.37.217.0/24
            154.37.218.0/24
            154.37.219.0/24
            154.37.220.0/24
            154.37.221.0/24
            154.37.222.0/24
            154.37.223.0/24
            154.40.42.0/24
            154.40.43.0/24
            154.40.44.0/23
            154.40.44.0/24
            154.40.45.0/24
            154.44.24.0/21
            154.44.24.0/24
            154.44.25.0/24
            154.44.26.0/24
            154.44.27.0/24
            154.44.28.0/24
            154.44.29.0/24
            154.44.30.0/24
            154.44.31.0/24
            154.64.244.0/22
            154.64.244.0/24
            154.64.245.0/24
            154.64.246.0/24
            154.64.247.0/24
            154.64.248.0/21
            154.64.248.0/24
            154.64.249.0/24
            154.64.250.0/24
            154.64.251.0/24
            154.64.252.0/24
            154.64.253.0/24
            154.64.254.0/24
            154.64.255.0/24        
        `
        }

    </script>

</body>

</html>